<h2 mat-dialog-title>Manage Your Managers</h2>
<mat-dialog-content>
  <p class="dialog-description">
    Managers have more access to Compliancechimp than your run-of-the-mill Team Member. They can add content to your library, start trainings, send out surveys, and complete self-inspections.<br><br>
    Because they have all this power, they need to create an account with Compliancechimp. You can add them below and we will send them an email to set their password and join your team.
  </p>
  
  <div class="managers-list">
    <!-- Add New Manager Card -->
    <div class="manager-card add-card" (click)="startManager()">
      <mat-icon>add</mat-icon>
      <span class="manager-name">Add a New Manager</span>
    </div>
    
    <!-- New Manager Form -->
    <div class="add-manager-form" *ngIf="newManager != null">
      <div class="form-title">Add a Manager</div>
      
      <mat-form-field appearance="outline">
        <mat-label>Name</mat-label>
        <input matInput [(ngModel)]="newManager.name" required>
      </mat-form-field>
      
      <mat-form-field appearance="outline">
        <mat-label>Email</mat-label>
        <input matInput [(ngModel)]="newManager.email" type="email" required>
      </mat-form-field>
      
      <mat-form-field appearance="outline">
        <mat-label>Job Title</mat-label>
        <input matInput [(ngModel)]="newManager.jobTitle">
      </mat-form-field>
      
      <mat-form-field appearance="outline">
        <mat-label>Phone (optional)</mat-label>
        <input matInput [(ngModel)]="newManager.phone" type="tel" (keyup)="formatPhone()">
        <mat-hint align="end" class="error-text" *ngIf="phoneError">Must be a valid phone number</mat-hint>
      </mat-form-field>
      
      <div class="form-actions">
        <button mat-button (click)="newManager = null">Cancel</button>
        <button mat-flat-button color="primary" [disabled]="!newManager.name || !newManager.email" (click)="createManager()">
          Add Manager
        </button>
      </div>
    </div>
    
    <!-- Existing Managers -->
    <div class="manager-card" *ngFor="let manager of Managers">
      <div class="manager-info">
        <div class="manager-name">
          {{ manager.name }}
          <span class="owner-badge" *ngIf="isOwner(manager.id)">Owner</span>
        </div>
        <div class="manager-email">{{ manager.email }}</div>
      </div>
      <!-- Menu for yourself (logged-in manager) -->
      <button mat-icon-button [matMenuTriggerFor]="youMenu" *ngIf="isYou(manager.id)">
        <mat-icon>more_vert</mat-icon>
      </button>
      <mat-menu #youMenu="matMenu">
        <button mat-menu-item (click)="viewYourUserPage()">
          <mat-icon>open_in_new</mat-icon>
          View Your User Page
        </button>
        <button mat-menu-item (click)="sendAccessLink()" [disabled]="sendingAccessLink">
          <mat-icon>email</mat-icon>
          {{ sendingAccessLink ? 'Sending...' : 'Send Access Link' }}
        </button>
      </mat-menu>
      <!-- Menu for other managers (not owner, not yourself) -->
      <button mat-icon-button [matMenuTriggerFor]="menu" *ngIf="!isYou(manager.id) && !isOwner(manager.id)">
        <mat-icon>more_vert</mat-icon>
      </button>
      <mat-menu #menu="matMenu">
        <button mat-menu-item (click)="removeManager(manager)">
          <mat-icon>person_remove</mat-icon>
          Remove {{ manager.name }}
        </button>
      </mat-menu>
    </div>
  </div>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button (click)="close()">Close</button>
</mat-dialog-actions>
