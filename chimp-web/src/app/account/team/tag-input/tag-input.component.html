<div class="tag-input-container" [class.compact]="compact">
  <div class="tag-list">
    @for (tag of tags; track $index) {
      <span 
        class="tag-pill"
        [style.backgroundColor]="getTagColor(tag).bg"
        [style.color]="getTagColor(tag).text"
        [style.borderColor]="getTagColor(tag).border">
        <span class="tag-dot" [style.backgroundColor]="getTagColor(tag).text"></span>
        {{ tag }}
        <button class="tag-remove" (click)="removeTag(tag)" [style.color]="getTagColor(tag).text">
          <mat-icon>close</mat-icon>
        </button>
      </span>
    }
  </div>
  
  <input
    #tagInput
    class="tag-text-input"
    [placeholder]="tags.length ? '' : placeholder"
    [(ngModel)]="inputValue"
    (ngModelChange)="onInputChange()"
    (keydown)="onKeydown($event)"
    [matAutocomplete]="auto">
  
  <mat-autocomplete #auto="matAutocomplete" (optionSelected)="selected($event)" panelWidth="auto">
    @for (tag of filteredTags; track $index) {
      <mat-option [value]="tag">
        <span class="autocomplete-tag">
          <span class="tag-dot" [style.backgroundColor]="getTagColor(tag).text"></span>
          {{ tag }}
        </span>
      </mat-option>
    }
    <mat-option *ngIf="inputValue.trim() && !allTags.includes(inputValue.trim())" [value]="inputValue.trim()">
      <span class="autocomplete-create">
        <mat-icon>add_circle</mat-icon>
        Create "{{ inputValue.trim() }}"
      </span>
    </mat-option>
  </mat-autocomplete>
</div>
